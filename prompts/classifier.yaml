# prompts/classifier.yaml  (≤2 KB)

task: >
  Classify the risk description into all applicable:
  NAICS Codes, SIC Codes, A.M. Best® Classes, ISO GL Classes, vehicle fleet,
  and appetite_flag (Undewrite | Refer | Decline Appetite | Decline Treaty | Decline Guidelines | Quote | Decline Underwriting Notes).

output_schema:
  naics: string               # e.g. 238120
  sic: string                 # e.g. 1795
  am_best_class: string       # e.g. Steel Erection
  iso_gl_code: string         # 5-digit number, e.g. 98174
  iso_gl_desc: string         # Title/description, e.g. "Steel Fabrication—shop"
  vehicle_types: list[string] # ["Private Passenger", "Light Truck"]
  appetite_flag: string       # "Quote" | "Refer" | "Decline"
  citations: list[string]     # Contextual source_ids

retrieval:                    # overrides system defaults
  top_k: 8
  min_score: 0.20
  filters:
    doc_type: ["am_best", "underwriting guideline","appetite", "treaty exclusions", "undewriting notes"]

instructions:
  - |
      Use breadcrumb metadata to rank context:

        1. BEST'S HAZARD INDEX
        2. SIC CODES AND CLASSIFICATIONS |
           NAICS CODES AND CLASSIFICATIONS |
           UNDERWRITING RELATED REPORTS
        3. RISK DESCRIPTION
        4. Lines of Coverage >
           General Liability: Premises and Operations |
           General Liability: Products - Completed Operations |
           Automobile Liability
        5. UNDERWRITER'S CHECKLIST
        

      When multiple chunks match, pick the one with the highest Retrieval score.
      iso_gl_code / iso_gl_desc, naics, and sic come primarily from the *Codes and Classifications* sections.
      Use the Hazard Index, Risk Description, Lines-of-Coverage, and Underwriter’s Checklist sections to set
      appetite_flag and provide underwriting rationale.
      Provide at least one citation (`{{source_id}}`) for every field.
      If any mandatory field has confidence < 0.5, respond `INSUFFICIENT_CONTEXT`.
  - Return JSON **only**—no extra prose.

few_shot_examples:
  - file: examples/cls_good.md
  - file: examples/cls_edge.md
  - file: examples/cls_bad.md
